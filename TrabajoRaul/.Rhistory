data <-read.table(file.choose(),header=T,sep=";", dec = ".")
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
wss<-numeric()
for(h in 2:10){
b<-kmeans(scale(data),h)
wss[h-1]<-b$tot.withinss
}
}
plot(2:10,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
set.seed(100)
wss<-numeric()
for(h in 2:10){
b<-kmeans(scale(data),h)
wss[h-1]<-b$tot.withinss
}
plot(2:10,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
wss<-numeric()
for(h in 2:11){
b<-kmeans(scale(data),h)
wss[h-1]<-b$tot.withinss
}
plot(2:11,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
wss<-numeric()
for(h in 2:11){
b<-kmeans(scale(data),h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:11,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(2:11,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
wss<-numeric()
for(h in 2:20){
b<-kmeans(scale(data),h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:20,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(1:19,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(1:20,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(1:20,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(1:20,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(1:19,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
for(h in 2:30){
b<-kmeans(scale(data),h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(1:29,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
set.seed(100)
wss<-numeric()
for(h in 2:30){
b<-kmeans(scale(data),h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(1:29,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
res<-kmeans(scale(data),13)
plot(scale(data),col=c("green","red", "blue", "black", "yellow")[res$cluster],pch=16)
res
View(res)
plot(scale(data),col=c("green","red", "blue", "black", "yellow")[res$cluster],pch=16)
plot(scale(data),col=c("green","red", "blue", "black", "yellow", "pink")[res$cluster],pch=16)
plot(scale(data),col=c("green","red", "blue", "black", "yellow", "pink", "brown")[res$cluster],pch=16)
plot(scale(data),col=c("green","red", "blue", "black", "yellow", "pink", "brown")[res$cluster],pch=16)
View(data)
plotcluster(scale(data), res$cluster)
library(fpc)
install.packages("fpc")
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
# Suma de cuadrados dentro de clusters
wss<-numeric()
plotcluster(scale(data), res$cluster)
library(fpc)
plotcluster(scale(data), res$cluster)
plot(scale(data),col=res$cluster)
points(res$center,col=1:2,pch=8,cex=1)
plotcluster(scale(data), res$cluster)
plot(scale(data),col=res$cluster)
points(res$center,col=1:9,pch=8,cex=1)
res$cluster
plotcluster(scale(data), res$cluster)
View(data)
sc<-scale(data)
View(sc)
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
head(data)
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
set.seed(100)
sc<-scale(data)
res<-kmeans(sc,13)
plot(sc,col=res$cluster,pch=20)
plot(c2~c1, sc,col=res$cluster,pch=20)
plot(res, sc,col=res$cluster,pch=20)
plot( sc,col=res$cluster,pch=20)
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
set.seed(100)
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(1:29,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data)
plotcluster(scale(data), res$cluster)
####################
sc<-scale(data)
res<-kmeans(sc,13)
plotcluster(res, res$cluster)
plotcluster(sc, res$cluster)
data.new<-cbind(data,res$cluster)
colnames(data.new)<-c(colnames(data.new[,-length(data.new)]), "cluster.km")
head(data.new)
write.table(data.new,file= "data_kmeans13.csv", dec=".", sep=";")
setwd("D:/ALMC/ILEN/BI Diplomado/Analytics/TrabajoRaul")
write.table(data.new,file= "data_kmeans13.csv", dec=".", sep=";")
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
head(data)
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
View(data)
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
head(data)
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
head(data)
set.seed(100)
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(1:29,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(1:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(1:29,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
set.seed(100)
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(1:29,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(2:29,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
View(data)
View(data)
data =data[,-(2:4)]
View(data)
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data)
res<-kmeans(sc,7)
plotcluster(sc, res$cluster)
View(data)
res<-kmeans(sc,2)
plotcluster(sc, res$cluster)
res<-kmeans(sc,3)
plotcluster(sc, res$cluster)
res<-kmeans(sc,3)
plotcluster(sc, res$cluster)
plotcluster(sc, res$cluster)
set.seed(100)
sc<-scale(data)
res<-kmeans(sc,3)
plotcluster(sc, res$cluster)
set.seed(100)
sc<-scale(data)
res<-kmeans(sc,4)
plotcluster(sc, res$cluster)
res<-kmeans(sc,4)
plotcluster(sc, res$cluster)
res$cluster
res
res<-kmeans(sc,4)
res
set.seed(100)
set.seed(100)
sc<-scale(data)
res<-kmeans(sc,4)
res$withinss
res<-kmeans(sc,4)
res$withinss
set.seed(100)
res<-kmeans(sc,4)
res$withinss
set.seed(100)
sc<-scale(data)
res<-kmeans(sc,4)
res$withinss
plotcluster(sc, res$cluster)
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
set.seed(100)
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
set.seed(100)
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
View(data)
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
set.seed(100)
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
data =data[,-(2:4)]
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
set.seed(100)
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
View(data)
sc<-scale(data)
set.seed(100)
res<-kmeans(sc,6)
plotcluster(sc, res$cluster)
set.seed(100)
res<-kmeans(sc,5)
plotcluster(sc, res$cluster)
set.seed(100)
res<-kmeans(sc,4)
plotcluster(sc, res$cluster)
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
View(data)
data =data[,-(2:2)]
View(data)
# Suma de cuadrados dentro de clusters
data =data[,-(3:3)]
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
set.seed(100)
b<-kmeans(sc,h,iter.max=30)
wss[h-1]<-b$tot.withinss
}
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data)
wss<-numeric()
for(h in 2:10){
set.seed(100)
b<-kmeans(sc,h)
wss[h-1]<-b$tot.withinss
}
plot(2:10,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
set.seed(100)
sc<-scale(data)
res<-kmeans(sc,6)
plotcluster(sc, res$cluster)
set.seed(100)
res<-kmeans(sc,6)
plotcluster(sc, res$cluster)
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
data.new =data[,-(12:13)] #eliminar salvaguardia e IVA
data.new =data.new[,-10] #eliminar peso neto
data.new =data.new[,-4] #eliminar otros
data.new =data.new[,-2] #eliminar usados, hay pocos importadores con usados
View(data.new)
sc<-scale(data)
wss<-numeric()
for(h in 2:10){
set.seed(100)
b<-kmeans(sc,h)
wss[h-1]<-b$tot.withinss
}
plot(2:10,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data)
wss<-numeric()
for(h in 2:30){
set.seed(100)
b<-kmeans(sc,h, iter.max = 30)
wss[h-1]<-b$tot.withinss
}
plot(2:30,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
wss<-numeric()
data.new =data[,-(12:13)] #eliminar salvaguardia e IVA
wss<-numeric()
for(h in 2:20){
set.seed(100)
b<-kmeans(sc,h, iter.max = 20)
wss[h-1]<-b$tot.withinss
}
plot(2:20,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data.new)
wss<-numeric()
for(h in 2:20){
set.seed(100)
b<-kmeans(sc,h, iter.max = 20)
wss[h-1]<-b$tot.withinss
}
plot(2:20,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data.new)
wss<-numeric()
for(h in 2:20){
b<-kmeans(sc,h, iter.max = 20)
wss[h-1]<-b$tot.withinss
}
plot(2:20,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data.new)
wss<-numeric()
for(h in 2:19){
b<-kmeans(sc,h)
wss[h-1]<-b$tot.withinss
}
plot(2:19,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
sc<-scale(data.new)
wss<-numeric()
wss<-numeric()
for(h in 2:19){
set.seed(100)
b<-kmeans(sc,h)
wss[h-1]<-b$tot.withinss
}
plot(2:19,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
plot(2:19,wss,type="b",xlab="Número de Cluster",ylab="Suma de los cuadrados dentro de cada grupo")
####################
set.seed(100)
sc<-scale(data.new)
res<-kmeans(sc,6)
plotcluster(sc, res$cluster)
View(sc)
data.new2<-cbind(data.new,res$cluster)
View(data.new2)
colnames(data.new2)<-c(colnames(data.new2[,-length(data.new2)]), "cluster.km")
View(data.new2)
write.table(data.new2,file= "data_kmeans6.csv", dec=".", sep=";")
View(data.new2)
data <-read.table(file.choose(),header=T,sep=";", dec = ".")
colnames(data) <- tolower(colnames(data))
nombres=data[,1]
data=data[,-1]
rownames(data)=nombres
data.new =data[,-(12:13)] #eliminar salvaguardia e IVA
data.new =data.new[,-10] #eliminar peso neto
data.new =data.new[,-4] #eliminar otros
data.new =data.new[,-2] #eliminar usados, hay pocos importadores con usados
set.seed(100)
sc<-scale(data.new)
res<-kmeans(sc,6)
res$withinss
data.fin<-cbind(data,res$cluster)
colnames(data.fin)<-c(colnames(data.fin[,-length(data.fin)]), "cluster.km")
write.table(data.fin,file= "data_kmeans6.csv", dec=".", sep=";")
write.table(data.fin,file= "data_kmeans6.csv", dec=".", sep=";")
